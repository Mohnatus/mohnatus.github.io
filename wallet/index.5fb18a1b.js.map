{"mappings":"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","sources":["<anon>","src/script.js","src/js/db/index.js","src/js/db/init.js","src/js/utils/notifier.js","src/js/db/constants.js","src/js/db/db.js","src/js/db/utils.js","src/js/db/items.js","src/js/db/tags.js","src/js/db/periods.js","src/js/store/index.js","src/js/store/emitter.js","src/js/store/events.js","src/js/store/constants.js","src/js/store/ids.js","src/js/store/items.js","src/js/store/state.js","src/js/store/periods.js","src/js/store/tags.js","src/js/view/index.js","src/js/view/itemForm.js","src/js/view/elements.js","src/js/view/tagForm.js","src/js/view/items.js","src/js/view/tags.js","src/js/view/periods.js","src/js/utils/date.js","src/subscribe.js"],"sourcesContent":["function $7cf706797b1cdf54$export$5e14cdade93d6f7b(message, data) {\n    alert(message);\n    console.info(message, data);\n}\nfunction $7cf706797b1cdf54$export$740944ffd2f8d33e(message, data) {\n    alert(message);\n    console.error(message, data);\n}\n\n\nconst $cb5f343bb15c779a$export$3c22ff8b64b8f565 = \"wallet\";\nconst $cb5f343bb15c779a$export$6a9022b4c5fcea02 = 4;\nconst $cb5f343bb15c779a$export$ecb8b5d0fe61b71e = \"items\";\nconst $cb5f343bb15c779a$export$1ccac7a1df77a4d0 = \"tags\";\nconst $cb5f343bb15c779a$export$a0ecdc0caa7bc41f = \"periods\";\n\n\nlet $10b482129a116bb0$var$dbRequest;\nfunction $10b482129a116bb0$export$5967dd4b7e75f835(db) {\n    $10b482129a116bb0$var$dbRequest = db;\n}\nfunction $10b482129a116bb0$export$208ba0bb7a79fe3e() {\n    return $10b482129a116bb0$var$dbRequest.result;\n}\n\n\n\nfunction $f0e3980f5caecdc4$export$6fec604aa7293d0c(storeName, toWrite) {\n    let db = (0, $10b482129a116bb0$export$208ba0bb7a79fe3e)();\n    let transaction = db.transaction(storeName, toWrite ? \"readwrite\" : \"readonly\");\n    let store = transaction.objectStore(storeName);\n    return store;\n}\n\n\nfunction $5bf8e0affdca911c$var$getItems() {\n    return new Promise((resolve)=>{\n        const items = (0, $f0e3980f5caecdc4$export$6fec604aa7293d0c)((0, $cb5f343bb15c779a$export$ecb8b5d0fe61b71e));\n        const request = items.getAll();\n        request.onsuccess = function() {\n            const result = request.result;\n            resolve(result);\n        };\n    });\n}\nasync function $5bf8e0affdca911c$var$getTags() {\n    return new Promise((resolve)=>{\n        const tags = (0, $f0e3980f5caecdc4$export$6fec604aa7293d0c)((0, $cb5f343bb15c779a$export$1ccac7a1df77a4d0));\n        const request = tags.getAll();\n        request.onsuccess = function() {\n            const result = request.result;\n            resolve(result);\n        };\n    });\n}\nasync function $5bf8e0affdca911c$var$getPeriods() {\n    return new Promise((resolve)=>{\n        const periods = (0, $f0e3980f5caecdc4$export$6fec604aa7293d0c)((0, $cb5f343bb15c779a$export$a0ecdc0caa7bc41f));\n        const request = periods.getAll();\n        request.onsuccess = function() {\n            const result = request.result;\n            resolve(result);\n        };\n    });\n}\nasync function $5bf8e0affdca911c$export$28e7436902e0cf8b() {\n    return new Promise((resolve)=>{\n        const dbRequest = indexedDB.open((0, $cb5f343bb15c779a$export$3c22ff8b64b8f565), (0, $cb5f343bb15c779a$export$6a9022b4c5fcea02));\n        dbRequest.onupgradeneeded = function() {\n            let db = dbRequest.result;\n            if (!db.objectStoreNames.contains((0, $cb5f343bb15c779a$export$ecb8b5d0fe61b71e))) db.createObjectStore((0, $cb5f343bb15c779a$export$ecb8b5d0fe61b71e), {\n                keyPath: \"id\"\n            });\n            if (!db.objectStoreNames.contains((0, $cb5f343bb15c779a$export$1ccac7a1df77a4d0))) db.createObjectStore((0, $cb5f343bb15c779a$export$1ccac7a1df77a4d0), {\n                keyPath: \"id\"\n            });\n            if (!db.objectStoreNames.contains((0, $cb5f343bb15c779a$export$a0ecdc0caa7bc41f))) db.createObjectStore((0, $cb5f343bb15c779a$export$a0ecdc0caa7bc41f), {\n                keyPath: \"id\"\n            });\n        };\n        dbRequest.onerror = function() {\n            (0, $7cf706797b1cdf54$export$740944ffd2f8d33e)(\"DB ERROR\", dbRequest.error);\n        };\n        dbRequest.onsuccess = function() {\n            Promise.all([\n                $5bf8e0affdca911c$var$getTags(),\n                $5bf8e0affdca911c$var$getItems(),\n                $5bf8e0affdca911c$var$getPeriods()\n            ]).then(([tags, items, periods])=>{\n                resolve({\n                    tags: tags,\n                    items: items,\n                    periods: periods\n                });\n            });\n        };\n        (0, $10b482129a116bb0$export$5967dd4b7e75f835)(dbRequest);\n    });\n}\n\n\n\n\n\nfunction $18fe714b7c5411fa$export$d9965447fadaae35(item) {\n    const items = (0, $f0e3980f5caecdc4$export$6fec604aa7293d0c)((0, $cb5f343bb15c779a$export$ecb8b5d0fe61b71e), true);\n    let request = items.add(item);\n    request.onsuccess = function() {\n        (0, $7cf706797b1cdf54$export$5e14cdade93d6f7b)(\"Запись успешно сохранена\");\n    };\n    request.onerror = function() {\n        (0, $7cf706797b1cdf54$export$740944ffd2f8d33e)(\"Не удалось сохранить запись\", request.error);\n    };\n}\nfunction $18fe714b7c5411fa$export$6d74f2e0bd134e69(item) {\n    let items = (0, $f0e3980f5caecdc4$export$6fec604aa7293d0c)((0, $cb5f343bb15c779a$export$ecb8b5d0fe61b71e), true);\n    let request = items.delete(item.id);\n    request.onsuccess = function() {\n        (0, $7cf706797b1cdf54$export$5e14cdade93d6f7b)(\"Запись успешно удалена\");\n    };\n    request.onerror = function() {\n        (0, $7cf706797b1cdf54$export$740944ffd2f8d33e)(\"Не удалось удалить запись\", request.error);\n    };\n}\n\n\n\n\n\nfunction $ab9cdb72c3c9787f$export$9136620570748e5(tag) {\n    let tags = (0, $f0e3980f5caecdc4$export$6fec604aa7293d0c)((0, $cb5f343bb15c779a$export$1ccac7a1df77a4d0), true);\n    let request = tags.add(tag);\n    request.onsuccess = function() {\n        (0, $7cf706797b1cdf54$export$5e14cdade93d6f7b)(\"Запись успешно сохранена\");\n    };\n    request.onerror = function() {\n        (0, $7cf706797b1cdf54$export$740944ffd2f8d33e)(\"Не удалось сохранить запись\", request.error);\n    };\n}\nfunction $ab9cdb72c3c9787f$export$db24519f95b43085(tag) {\n    let tags = (0, $f0e3980f5caecdc4$export$6fec604aa7293d0c)((0, $cb5f343bb15c779a$export$1ccac7a1df77a4d0), true);\n    let request = tags.delete(tag.id);\n    request.onsuccess = function() {\n        (0, $7cf706797b1cdf54$export$5e14cdade93d6f7b)(\"Запись успешно удалена\");\n    };\n    request.onerror = function() {\n        (0, $7cf706797b1cdf54$export$740944ffd2f8d33e)(\"Не удалось удалить запись\", request.error);\n    };\n}\n\n\n\n\n\nfunction $d427684b5f3168ee$export$e2a0d46e1b66d1c3(period) {\n    const periods = (0, $f0e3980f5caecdc4$export$6fec604aa7293d0c)((0, $cb5f343bb15c779a$export$a0ecdc0caa7bc41f), true);\n    let request = periods.add(period);\n    request.onsuccess = function() {\n        (0, $7cf706797b1cdf54$export$5e14cdade93d6f7b)(\"Запись успешно сохранена\");\n    };\n    request.onerror = function() {\n        (0, $7cf706797b1cdf54$export$740944ffd2f8d33e)(\"Не удалось сохранить запись\", request.error);\n    };\n}\nfunction $d427684b5f3168ee$export$713c4cdea7446c01(period) {\n    let periods = (0, $f0e3980f5caecdc4$export$6fec604aa7293d0c)((0, $cb5f343bb15c779a$export$a0ecdc0caa7bc41f), true);\n    let request = periods.delete(period.id);\n    request.onsuccess = function() {\n        (0, $7cf706797b1cdf54$export$5e14cdade93d6f7b)(\"Запись успешно удалена\");\n    };\n    request.onerror = function() {\n        (0, $7cf706797b1cdf54$export$740944ffd2f8d33e)(\"Не удалось удалить запись\", request.error);\n    };\n}\n\n\n\n\nconst $c5b9a1c6f844f372$var$callbacks = {};\nfunction $c5b9a1c6f844f372$export$ec068583843480e7(eventName, eventCb) {\n    if (!(eventName in $c5b9a1c6f844f372$var$callbacks)) $c5b9a1c6f844f372$var$callbacks[eventName] = [];\n    $c5b9a1c6f844f372$var$callbacks[eventName].push(eventCb);\n}\nfunction $c5b9a1c6f844f372$export$8f35fbd5db0f3634(eventName, eventData) {\n    const eventCallbacks = $c5b9a1c6f844f372$var$callbacks[eventName];\n    if (!eventCallbacks) return;\n    eventCallbacks.forEach((cb)=>cb(eventData));\n}\n\n\nconst $a781e7bcb429c993$export$4bf9923669ad6c63 = {\n    inited: \"store/inited\",\n    addItem: \"item/add\",\n    removeItem: \"item/remove\",\n    addTag: \"tag/add\",\n    removeTag: \"tag/remove\",\n    addPeriod: \"period/add\",\n    removePeriod: \"period/remove\",\n    setActivePeriod: \"activePeriod/set\"\n};\n\n\nconst $263aeadb784ad8cc$export$f55270c8f0a4bc82 = {\n    items: \"items\",\n    periods: \"periods\",\n    tags: \"tags\"\n};\n\n\nconst $22192c93a4d7ed30$var$ids = {};\nfunction $22192c93a4d7ed30$export$bfc4ad7c1c5887fd(fieldName) {\n    if (!(fieldName in $22192c93a4d7ed30$var$ids)) $22192c93a4d7ed30$var$ids[fieldName] = 0;\n    return ++$22192c93a4d7ed30$var$ids[fieldName];\n}\nfunction $22192c93a4d7ed30$export$8e3473c3c882e000(fieldName, id) {\n    $22192c93a4d7ed30$var$ids[fieldName] = id;\n}\n\n\n\n\n\n\nconst $39a9d2055ff57bb2$var$state = {\n    items: [],\n    tags: [],\n    periods: [],\n    activePeriod: null\n};\nfunction $39a9d2055ff57bb2$export$50fdfeece43146fd() {\n    return {\n        ...$39a9d2055ff57bb2$var$state\n    };\n}\nfunction $39a9d2055ff57bb2$export$41f27b3823a442c6({ tags: tagsList, items: itemsList, periods: periodsList }) {\n    if (tagsList.length > 0) {\n        (0, $22192c93a4d7ed30$export$8e3473c3c882e000)((0, $263aeadb784ad8cc$export$f55270c8f0a4bc82).tags, tagsList[tagsList.length - 1].id);\n        $39a9d2055ff57bb2$var$state.tags = tagsList;\n    }\n    if (itemsList.length > 0) {\n        (0, $22192c93a4d7ed30$export$8e3473c3c882e000)((0, $263aeadb784ad8cc$export$f55270c8f0a4bc82).items, itemsList[itemsList.length - 1].id);\n        $39a9d2055ff57bb2$var$state.items = itemsList;\n    }\n    if (periodsList.length > 0) {\n        const lastPeriod = periodsList[periodsList.length - 1];\n        (0, $22192c93a4d7ed30$export$8e3473c3c882e000)((0, $263aeadb784ad8cc$export$f55270c8f0a4bc82).periods, lastPeriod.id);\n        $39a9d2055ff57bb2$var$state.periods = periodsList;\n        $39a9d2055ff57bb2$var$state.activePeriod = lastPeriod;\n    }\n    (0, $c5b9a1c6f844f372$export$8f35fbd5db0f3634)((0, $a781e7bcb429c993$export$4bf9923669ad6c63).inited, $39a9d2055ff57bb2$var$state);\n}\nfunction $39a9d2055ff57bb2$export$fb9705de59d96855(item) {\n    $39a9d2055ff57bb2$var$state.items.push(item);\n    (0, $c5b9a1c6f844f372$export$8f35fbd5db0f3634)((0, $a781e7bcb429c993$export$4bf9923669ad6c63).addItem, item);\n}\nfunction $39a9d2055ff57bb2$export$d220bf936897c3f(tag) {\n    $39a9d2055ff57bb2$var$state.tags.push(tag);\n    (0, $c5b9a1c6f844f372$export$8f35fbd5db0f3634)((0, $a781e7bcb429c993$export$4bf9923669ad6c63).addTag, tag);\n}\nfunction $39a9d2055ff57bb2$export$960d87f3af6d13d2(period) {\n    $39a9d2055ff57bb2$var$state.periods.push(period);\n    (0, $c5b9a1c6f844f372$export$8f35fbd5db0f3634)((0, $a781e7bcb429c993$export$4bf9923669ad6c63).addPeriod, period);\n}\nfunction $39a9d2055ff57bb2$export$fe2d9b4e03920b4c(item) {\n    $39a9d2055ff57bb2$var$state.items = $39a9d2055ff57bb2$var$state.items.filter((i)=>i.id !== item.id);\n    (0, $c5b9a1c6f844f372$export$8f35fbd5db0f3634)((0, $a781e7bcb429c993$export$4bf9923669ad6c63).removeItem, item);\n}\nfunction $39a9d2055ff57bb2$export$c21dc7c320b3abf4(tag) {\n    $39a9d2055ff57bb2$var$state.tags = $39a9d2055ff57bb2$var$state.tags.filter((t)=>t.id !== tag.id);\n    (0, $c5b9a1c6f844f372$export$8f35fbd5db0f3634)((0, $a781e7bcb429c993$export$4bf9923669ad6c63).removeTag, tag);\n}\nfunction $39a9d2055ff57bb2$export$fa468d4bfa9d25b2(period) {\n    $39a9d2055ff57bb2$var$state.periods = $39a9d2055ff57bb2$var$state.items.filter((p)=>p.id !== period.id);\n    (0, $c5b9a1c6f844f372$export$8f35fbd5db0f3634)((0, $a781e7bcb429c993$export$4bf9923669ad6c63).removePeriod, period);\n}\nfunction $39a9d2055ff57bb2$export$7c7da73463e50efc(period) {\n    $39a9d2055ff57bb2$var$state.activePeriod = period;\n    (0, $c5b9a1c6f844f372$export$8f35fbd5db0f3634)((0, $a781e7bcb429c993$export$4bf9923669ad6c63).setActivePeriod, period);\n}\n\n\nfunction $300f44f1e0ff59c8$export$3978dea8a714b756() {\n    return [\n        ...(0, $39a9d2055ff57bb2$export$50fdfeece43146fd)().items\n    ];\n}\nfunction $300f44f1e0ff59c8$export$706e833710f71429(itemId) {\n    const items = $300f44f1e0ff59c8$export$3978dea8a714b756();\n    return items.find((i)=>i.id === itemId);\n}\nfunction $300f44f1e0ff59c8$export$a59067c931da7aa8() {\n    const items = [];\n    (0, $39a9d2055ff57bb2$export$50fdfeece43146fd)().items.forEach((item)=>{\n        items.push(item);\n        items.push(...item.subitems);\n    });\n    return items;\n}\nfunction $300f44f1e0ff59c8$export$6d93898069d99b40(tagId) {\n    const items = $300f44f1e0ff59c8$export$a59067c931da7aa8();\n    return items.filter((i)=>i.tag === tagId);\n}\nfunction $300f44f1e0ff59c8$export$32d38b1480545060() {\n    const state = (0, $39a9d2055ff57bb2$export$50fdfeece43146fd)();\n    const period = state.activePeriod;\n    if (!period) return [\n        ...state.items\n    ];\n    const periodIndex = state.periods.findIndex((p)=>p.id === period.id);\n    const nextPeriod = state.periods[periodIndex + 1];\n    return state.items.filter((item)=>{\n        if (period.createdAt && item.createdAt < period.createdAt) return false;\n        if (nextPeriod && item.createdAt >= nextPeriod.createdAt) return false;\n        return true;\n    });\n}\n\n\n\nfunction $3a22c8333e3ffd71$export$7644b46c44c62576() {\n    return (0, $39a9d2055ff57bb2$export$50fdfeece43146fd)().periods;\n}\nfunction $3a22c8333e3ffd71$export$d28142a7033885bd(periodId) {\n    const periods = $3a22c8333e3ffd71$export$7644b46c44c62576();\n    return periods.find((p)=>p.id === periodId);\n}\nfunction $3a22c8333e3ffd71$export$43f6d0e40c51b9cd() {\n    return (0, $39a9d2055ff57bb2$export$50fdfeece43146fd)().activePeriod;\n}\n\n\n\n\nfunction $234be5d0c6d8086c$export$5b2aa3892c7cd563() {\n    return [\n        ...(0, $39a9d2055ff57bb2$export$50fdfeece43146fd)().tags\n    ];\n}\nfunction $234be5d0c6d8086c$export$187dba9db79742da(tagId) {\n    const tags = $234be5d0c6d8086c$export$5b2aa3892c7cd563();\n    return tags.find((t)=>t.id === tagId);\n}\nfunction $234be5d0c6d8086c$var$selectTagsWeight() {\n    const state = (0, $39a9d2055ff57bb2$export$50fdfeece43146fd)();\n    const items = (0, $300f44f1e0ff59c8$export$a59067c931da7aa8)();\n    const weight = {};\n    state.tags.forEach((tag)=>{\n        weight[tag.id] = 0;\n    });\n    items.forEach((item)=>{\n        weight[item.tag] += 1;\n    });\n    return weight;\n}\nfunction $234be5d0c6d8086c$export$7683f595ce888d9d() {\n    const tags = $234be5d0c6d8086c$export$5b2aa3892c7cd563();\n    const weight = $234be5d0c6d8086c$var$selectTagsWeight();\n    tags.sort((a, b)=>weight[b.id] - weight[a.id]);\n    return tags;\n}\n\n\n\n\n\n\nconst $562b1b97bd523649$export$82babaa65029102d = {\n    items: {\n        list: \"items\",\n        template: \"item-tmpl\",\n        subitemTemplate: \"subitem-tmpl\"\n    },\n    itemForm: {\n        dialog: \"new-item-dialog\",\n        form: \"new-item-form\",\n        addButton: \"add-item\",\n        closeButton: \"close-new-item-dialog\",\n        subitemsList: \"new-item-form-subitems\",\n        tagsSelect: \"tags-select\",\n        addSubitemBtn: \"new-item-add-subitem\",\n        subitemTemplate: \"subitem-form-tmpl\"\n    },\n    tags: {\n        list: \"tags\",\n        template: \"tag-tmpl\",\n        aside: \"tags-sidebar\",\n        toggleListBtn: \"tags-toggle\"\n    },\n    tagForm: {\n        dialog: \"new-tag-dialog\",\n        form: \"new-tag-form\",\n        addButton: \"add-tag\",\n        closeButton: \"close-new-tag-dialog\"\n    },\n    periods: {\n        toggleButton: \"periods-toggle\",\n        startButton: \"start-period\",\n        aside: \"periods-sidebar\",\n        list: \"periods-list\",\n        periodTemplate: \"period-tmpl\"\n    }\n};\nconst $562b1b97bd523649$var$cache = {};\nfunction $562b1b97bd523649$export$d16800b7e59a8051(id) {\n    if ($562b1b97bd523649$var$cache[id]) return $562b1b97bd523649$var$cache[id];\n    const element = document.getElementById(id);\n    $562b1b97bd523649$var$cache[id] = element;\n    return element;\n}\nfunction $562b1b97bd523649$export$9b1a70d8e05b0fa6(id) {\n    const template = $562b1b97bd523649$export$d16800b7e59a8051(id);\n    const $clone = template.content.cloneNode(true);\n    return $clone;\n}\n\n\nconst $88ae43dff40ab9c2$var$selectors = {\n    subitem: \".subitem-form\"\n};\nfunction $88ae43dff40ab9c2$var$renderSubitemForm() {\n    const $clone = (0, $562b1b97bd523649$export$9b1a70d8e05b0fa6)((0, $562b1b97bd523649$export$82babaa65029102d).itemForm.subitemTemplate);\n    const $subitem = $clone.querySelector($88ae43dff40ab9c2$var$selectors.subitem);\n    const $subitemSelect = $subitem.querySelector(\"select\");\n    const tags = (0, $234be5d0c6d8086c$export$7683f595ce888d9d)();\n    tags.forEach((tag)=>{\n        const $tag = $88ae43dff40ab9c2$var$renderTagOption(tag);\n        $subitemSelect.appendChild($tag);\n    });\n    return $subitem;\n}\nfunction $88ae43dff40ab9c2$var$renderTagOption(tag) {\n    const $option = document.createElement(\"option\");\n    $option.textContent = tag.name;\n    $option.value = tag.id;\n    return $option;\n}\nfunction $88ae43dff40ab9c2$export$a7d31dc4e9b4d21a(tags) {\n    const $tagsSelect = (0, $562b1b97bd523649$export$d16800b7e59a8051)((0, $562b1b97bd523649$export$82babaa65029102d).itemForm.tagsSelect);\n    $tagsSelect.innerHTML = \"\";\n    tags.forEach((tag)=>{\n        const $option = $88ae43dff40ab9c2$var$renderTagOption(tag);\n        $tagsSelect.appendChild($option);\n    });\n}\nfunction $88ae43dff40ab9c2$var$resetNewItemForm() {\n    const $newItemForm = (0, $562b1b97bd523649$export$d16800b7e59a8051)((0, $562b1b97bd523649$export$82babaa65029102d).itemForm.form);\n    const $newItemFormSubitemsList = (0, $562b1b97bd523649$export$d16800b7e59a8051)((0, $562b1b97bd523649$export$82babaa65029102d).itemForm.subitemsList);\n    $newItemForm.reset();\n    $newItemFormSubitemsList.innerHTML = \"\";\n}\nfunction $88ae43dff40ab9c2$var$openNewItemForm() {\n    const $newItemDialog = (0, $562b1b97bd523649$export$d16800b7e59a8051)((0, $562b1b97bd523649$export$82babaa65029102d).itemForm.dialog);\n    $newItemDialog.showModal();\n}\nfunction $88ae43dff40ab9c2$export$2f62053d3c3a3e3e() {\n    const $newItemDialog = (0, $562b1b97bd523649$export$d16800b7e59a8051)((0, $562b1b97bd523649$export$82babaa65029102d).itemForm.dialog);\n    $newItemDialog.close();\n    $88ae43dff40ab9c2$var$resetNewItemForm();\n}\nfunction $88ae43dff40ab9c2$var$getNewItemFormData() {\n    const $newItemForm = (0, $562b1b97bd523649$export$d16800b7e59a8051)((0, $562b1b97bd523649$export$82babaa65029102d).itemForm.form);\n    const fd = new FormData($newItemForm);\n    const subitemTexts = fd.getAll(\"subitems[text][]\");\n    const subitemPrices = fd.getAll(\"subitems[price][]\");\n    const subitemTags = fd.getAll(\"subitems[tag][]\");\n    return {\n        text: fd.get(\"text\"),\n        price: fd.get(\"price\"),\n        tag: Number(fd.get(\"tag\")),\n        subitems: subitemTexts.map((text, i)=>{\n            return {\n                text: text,\n                price: subitemPrices[i],\n                tag: Number(subitemTags[i])\n            };\n        })\n    };\n}\nfunction $88ae43dff40ab9c2$export$5aaae3b85e8f235d(config) {\n    const { onSubmit: onSubmit } = config;\n    const $newItemForm = (0, $562b1b97bd523649$export$d16800b7e59a8051)((0, $562b1b97bd523649$export$82babaa65029102d).itemForm.form);\n    const $addItemButton = (0, $562b1b97bd523649$export$d16800b7e59a8051)((0, $562b1b97bd523649$export$82babaa65029102d).itemForm.addButton);\n    const $closeDialogButton = (0, $562b1b97bd523649$export$d16800b7e59a8051)((0, $562b1b97bd523649$export$82babaa65029102d).itemForm.closeButton);\n    const $addSubitemButton = (0, $562b1b97bd523649$export$d16800b7e59a8051)((0, $562b1b97bd523649$export$82babaa65029102d).itemForm.addSubitemBtn);\n    const $subitemsList = (0, $562b1b97bd523649$export$d16800b7e59a8051)((0, $562b1b97bd523649$export$82babaa65029102d).itemForm.subitemsList);\n    $newItemForm.addEventListener(\"submit\", (e)=>{\n        e.preventDefault();\n        onSubmit($88ae43dff40ab9c2$var$getNewItemFormData());\n    });\n    $addItemButton.addEventListener(\"click\", ()=>{\n        $88ae43dff40ab9c2$var$openNewItemForm();\n    });\n    $closeDialogButton.addEventListener(\"click\", ()=>{\n        $88ae43dff40ab9c2$export$2f62053d3c3a3e3e();\n    });\n    $addSubitemButton.addEventListener(\"click\", ()=>{\n        const $subitemForm = $88ae43dff40ab9c2$var$renderSubitemForm();\n        $subitemsList.appendChild($subitemForm);\n    });\n}\n\n\n\n\n\nfunction $84e1707131c903ad$var$resetNewTagForm() {\n    const $newTagForm = (0, $562b1b97bd523649$export$d16800b7e59a8051)((0, $562b1b97bd523649$export$82babaa65029102d).tagForm.form);\n    $newTagForm.reset();\n}\nfunction $84e1707131c903ad$var$openNewTagForm() {\n    const $newTagDialog = (0, $562b1b97bd523649$export$d16800b7e59a8051)((0, $562b1b97bd523649$export$82babaa65029102d).tagForm.dialog);\n    $newTagDialog.showModal();\n}\nfunction $84e1707131c903ad$export$6e142ec7d834c3f8() {\n    const $newTagDialog = (0, $562b1b97bd523649$export$d16800b7e59a8051)((0, $562b1b97bd523649$export$82babaa65029102d).tagForm.dialog);\n    $newTagDialog.close();\n    $84e1707131c903ad$var$resetNewTagForm();\n}\nfunction $84e1707131c903ad$var$getNewTagFormData() {\n    const $newTagForm = (0, $562b1b97bd523649$export$d16800b7e59a8051)((0, $562b1b97bd523649$export$82babaa65029102d).tagForm.form);\n    return {\n        name: $newTagForm.elements.name.value\n    };\n}\nfunction $84e1707131c903ad$export$5b882f86b632414c(config) {\n    const { onSubmit: onSubmit } = config;\n    const $newTagForm = (0, $562b1b97bd523649$export$d16800b7e59a8051)((0, $562b1b97bd523649$export$82babaa65029102d).tagForm.form);\n    const $addTagButton = (0, $562b1b97bd523649$export$d16800b7e59a8051)((0, $562b1b97bd523649$export$82babaa65029102d).tagForm.addButton);\n    const $closeDialogButton = (0, $562b1b97bd523649$export$d16800b7e59a8051)((0, $562b1b97bd523649$export$82babaa65029102d).tagForm.closeButton);\n    $newTagForm.addEventListener(\"submit\", (e)=>{\n        e.preventDefault();\n        const formData = $84e1707131c903ad$var$getNewTagFormData();\n        if (!formData.name) {\n            (0, $7cf706797b1cdf54$export$740944ffd2f8d33e)(\"Не заполнено поле name\", {\n                formData: formData\n            });\n            return;\n        }\n        const tags = (0, $234be5d0c6d8086c$export$5b2aa3892c7cd563)();\n        const isDouble = tags.some((t)=>t.name === formData.name);\n        if (isDouble) {\n            (0, $7cf706797b1cdf54$export$740944ffd2f8d33e)(`Тег с именем ${formData.name} уже добавлен`, {\n                formData: formData\n            });\n            return;\n        }\n        onSubmit(formData);\n    });\n    $addTagButton.addEventListener(\"click\", ()=>{\n        $84e1707131c903ad$var$openNewTagForm();\n    });\n    $closeDialogButton.addEventListener(\"click\", ()=>{\n        $84e1707131c903ad$export$6e142ec7d834c3f8();\n    });\n}\n\n\n\n\nconst $c151cb9ebf0d3253$var$selectors = {\n    item: \".item\",\n    itemText: \".item-text\",\n    itemPrice: \".item-price\",\n    itemTag: \".item-tag\",\n    itemRemove: \".item-remove\",\n    subitems: \".item-subitems\",\n    subitem: \".subitem\",\n    subitemText: \".subitem-text\",\n    subitemPrice: \".subitem-price\",\n    subitemTag: \".subitem-tag\"\n};\nfunction $c151cb9ebf0d3253$var$renderSubitem(subitem) {\n    const $clone = (0, $562b1b97bd523649$export$9b1a70d8e05b0fa6)((0, $562b1b97bd523649$export$82babaa65029102d).items.subitemTemplate);\n    const $subitem = $clone.querySelector($c151cb9ebf0d3253$var$selectors.subitem);\n    $subitem.querySelector($c151cb9ebf0d3253$var$selectors.subitemText).textContent = subitem.text;\n    $subitem.querySelector($c151cb9ebf0d3253$var$selectors.subitemPrice).textContent = subitem.price;\n    const subitemTag = (0, $234be5d0c6d8086c$export$187dba9db79742da)(subitem.tag);\n    $subitem.querySelector($c151cb9ebf0d3253$var$selectors.subitemTag).textContent = subitemTag?.name || \"\";\n    return $subitem;\n}\nfunction $c151cb9ebf0d3253$var$renderItem(item) {\n    const $clone = (0, $562b1b97bd523649$export$9b1a70d8e05b0fa6)((0, $562b1b97bd523649$export$82babaa65029102d).items.template);\n    const $item = $clone.querySelector($c151cb9ebf0d3253$var$selectors.item);\n    $item.dataset.itemId = item.id;\n    $item.querySelector($c151cb9ebf0d3253$var$selectors.itemText).textContent = item.text;\n    $item.querySelector($c151cb9ebf0d3253$var$selectors.itemPrice).textContent = item.price;\n    const itemTag = (0, $234be5d0c6d8086c$export$187dba9db79742da)(item.tag);\n    $item.querySelector($c151cb9ebf0d3253$var$selectors.itemTag).textContent = itemTag?.name || \"\";\n    if (item.subitems?.length > 0) {\n        const $subitemsList = $item.querySelector($c151cb9ebf0d3253$var$selectors.subitems);\n        item.subitems.forEach((subitem)=>{\n            const $subitem = $c151cb9ebf0d3253$var$renderSubitem(subitem);\n            $subitemsList.appendChild($subitem);\n        });\n    }\n    return $item;\n}\nfunction $c151cb9ebf0d3253$export$a073caafba2bf897(items) {\n    const $itemsList = (0, $562b1b97bd523649$export$d16800b7e59a8051)((0, $562b1b97bd523649$export$82babaa65029102d).items.list);\n    $itemsList.innerHTML = \"\";\n    items.forEach((item)=>{\n        const $item = $c151cb9ebf0d3253$var$renderItem(item);\n        $itemsList.appendChild($item);\n    });\n}\nfunction $c151cb9ebf0d3253$export$c1a4300032ac0b7e(item) {\n    const $item = $c151cb9ebf0d3253$var$renderItem(item);\n    const $itemsList = (0, $562b1b97bd523649$export$d16800b7e59a8051)((0, $562b1b97bd523649$export$82babaa65029102d).items.list);\n    $itemsList.appendChild($item);\n}\nfunction $c151cb9ebf0d3253$export$557da4bd554f1d64(itemId) {\n    const $element = document.querySelector(`[data-item-id=\"${itemId}\"]`);\n    $element.remove();\n}\nfunction $c151cb9ebf0d3253$export$ec6607eeb8c2a5d9(config) {\n    const { onRemove: onRemove } = config;\n    const $itemsList = (0, $562b1b97bd523649$export$d16800b7e59a8051)((0, $562b1b97bd523649$export$82babaa65029102d).items.list);\n    $itemsList.addEventListener(\"click\", (e)=>{\n        const $removeButton = e.target.closest($c151cb9ebf0d3253$var$selectors.itemRemove);\n        if ($removeButton) {\n            const $tag = e.target.closest($c151cb9ebf0d3253$var$selectors.item);\n            onRemove(Number($tag.dataset.itemId));\n        }\n    });\n}\n\n\n\nconst $b5a61f6ff1db7acf$var$selectors = {\n    tag: \".tag\",\n    tagName: \".tag-name\",\n    tagRemove: \".tag-remove\"\n};\nfunction $b5a61f6ff1db7acf$var$renderTag(tag) {\n    const $clone = (0, $562b1b97bd523649$export$9b1a70d8e05b0fa6)((0, $562b1b97bd523649$export$82babaa65029102d).tags.template);\n    const $tag = $clone.querySelector($b5a61f6ff1db7acf$var$selectors.tag);\n    $tag.dataset.tagId = tag.id;\n    $tag.querySelector($b5a61f6ff1db7acf$var$selectors.tagName).textContent = tag.name;\n    return $tag;\n}\nfunction $b5a61f6ff1db7acf$export$5153dfacc9e003db(tags) {\n    const $tagsList = (0, $562b1b97bd523649$export$d16800b7e59a8051)((0, $562b1b97bd523649$export$82babaa65029102d).tags.list);\n    $tagsList.innerHTML = \"\";\n    tags.forEach((tag)=>{\n        const $tag = $b5a61f6ff1db7acf$var$renderTag(tag);\n        $tagsList.appendChild($tag);\n    });\n}\nfunction $b5a61f6ff1db7acf$export$5aae0045fcf71e3a(tag) {\n    const $tagsList = (0, $562b1b97bd523649$export$d16800b7e59a8051)((0, $562b1b97bd523649$export$82babaa65029102d).tags.list);\n    const $tag = $b5a61f6ff1db7acf$var$renderTag(tag);\n    $tagsList.appendChild($tag);\n}\nfunction $b5a61f6ff1db7acf$export$400216edc5450072(tagId) {\n    const $element = document.querySelector(`[data-tag-id=\"${tagId}\"]`);\n    $element.remove();\n}\nfunction $b5a61f6ff1db7acf$export$68277c4d50aef9d4(config) {\n    const { onRemove: onRemove } = config;\n    const $tagsList = (0, $562b1b97bd523649$export$d16800b7e59a8051)((0, $562b1b97bd523649$export$82babaa65029102d).tags.list);\n    $tagsList.addEventListener(\"click\", (e)=>{\n        const $removeButton = e.target.closest($b5a61f6ff1db7acf$var$selectors.tagRemove);\n        if ($removeButton) {\n            const $tag = e.target.closest($b5a61f6ff1db7acf$var$selectors.tag);\n            onRemove(Number($tag.dataset.tagId));\n        }\n    });\n    const $tagsToggleButton = (0, $562b1b97bd523649$export$d16800b7e59a8051)((0, $562b1b97bd523649$export$82babaa65029102d).tags.toggleListBtn);\n    const $tagsSidebar = (0, $562b1b97bd523649$export$d16800b7e59a8051)((0, $562b1b97bd523649$export$82babaa65029102d).tags.aside);\n    $tagsToggleButton.addEventListener(\"click\", ()=>{\n        if ($tagsSidebar.hasAttribute(\"data-open\")) $tagsSidebar.removeAttribute(\"data-open\");\n        else $tagsSidebar.setAttribute(\"data-open\", \"true\");\n    });\n}\n\n\nfunction $133b04bf6dc64688$export$3ae94a2503e890a1(date) {\n    return `${date.getDate()}.${date.getMonth() + 1}.${date.getFullYear()}`;\n}\n\n\n\nconst $44e8dcf7bc1235ff$var$selectors = {\n    period: \".period\",\n    periodStart: \".period-start\",\n    periodEnd: \".period-end\",\n    periodRemove: \".period-remove\"\n};\nfunction $44e8dcf7bc1235ff$var$renderPeriod(period, nextPeriod) {\n    const $clone = (0, $562b1b97bd523649$export$9b1a70d8e05b0fa6)((0, $562b1b97bd523649$export$82babaa65029102d).periods.periodTemplate);\n    const $period = $clone.querySelector($44e8dcf7bc1235ff$var$selectors.period);\n    $period.dataset.periodId = period.id;\n    const start = new Date(period.createdAt);\n    const end = nextPeriod ? new Date(nextPeriod.createdAt) : null;\n    $period.querySelector($44e8dcf7bc1235ff$var$selectors.periodStart).textContent = `с ${(0, $133b04bf6dc64688$export$3ae94a2503e890a1)(start)}`;\n    $period.querySelector($44e8dcf7bc1235ff$var$selectors.periodEnd).textContent = end ? `по ${(0, $133b04bf6dc64688$export$3ae94a2503e890a1)(end)}` : `...`;\n    return $period;\n}\nfunction $44e8dcf7bc1235ff$export$2b2125c41df5d77(periods) {\n    const $periodsList = (0, $562b1b97bd523649$export$d16800b7e59a8051)((0, $562b1b97bd523649$export$82babaa65029102d).periods.list);\n    $periodsList.innerHTML = \"\";\n    periods.forEach((period, i)=>{\n        const $period = $44e8dcf7bc1235ff$var$renderPeriod(period, periods[i + 1]);\n        $periodsList.appendChild($period);\n    });\n}\nfunction $44e8dcf7bc1235ff$export$3852f45ed1ebb45d(period) {\n    const $periodsList = (0, $562b1b97bd523649$export$d16800b7e59a8051)((0, $562b1b97bd523649$export$82babaa65029102d).periods.list);\n    const $period = $44e8dcf7bc1235ff$var$renderPeriod(period);\n    $periodsList.appendChild($period);\n}\nfunction $44e8dcf7bc1235ff$export$27ab5fa15e02a16a(periodId) {\n    const $element = document.querySelector(`[data-period-id=\"${periodId}\"]`);\n    $element.remove();\n}\nfunction $44e8dcf7bc1235ff$export$20db971c1716cf73(config) {\n    const { onStart: onStart, onRemove: onRemove, onSelect: onSelect } = config;\n    const $toggleButton = (0, $562b1b97bd523649$export$d16800b7e59a8051)((0, $562b1b97bd523649$export$82babaa65029102d).periods.toggleButton);\n    const $periodsSidebar = (0, $562b1b97bd523649$export$d16800b7e59a8051)((0, $562b1b97bd523649$export$82babaa65029102d).periods.aside);\n    const $periodsList = (0, $562b1b97bd523649$export$d16800b7e59a8051)((0, $562b1b97bd523649$export$82babaa65029102d).periods.list);\n    const $startButton = (0, $562b1b97bd523649$export$d16800b7e59a8051)((0, $562b1b97bd523649$export$82babaa65029102d).periods.startButton);\n    $toggleButton.addEventListener(\"click\", ()=>{\n        if ($periodsSidebar.hasAttribute(\"data-open\")) $periodsSidebar.removeAttribute(\"data-open\");\n        else $periodsSidebar.setAttribute(\"data-open\", \"true\");\n    });\n    $periodsList.addEventListener(\"click\", (e)=>{\n        const $removeButton = e.target.closest($44e8dcf7bc1235ff$var$selectors.periodRemove);\n        if ($removeButton) {\n            const $period = e.target.closest($44e8dcf7bc1235ff$var$selectors.period);\n            onRemove(Number($period.dataset.periodId));\n            return;\n        }\n        const $period = e.target.closest($44e8dcf7bc1235ff$var$selectors.period);\n        if ($period) onSelect(Number($period.dataset.periodId));\n    });\n    $startButton.addEventListener(\"click\", onStart);\n}\nfunction $44e8dcf7bc1235ff$export$9db81c2826f1f86f(period) {}\n\n\n\n\n\n\n\nfunction $f4155ce6e97e26c2$var$updateTagsHelper() {\n    (0, $88ae43dff40ab9c2$export$a7d31dc4e9b4d21a)((0, $234be5d0c6d8086c$export$7683f595ce888d9d)());\n}\nfunction $f4155ce6e97e26c2$export$718a88b4a3261429() {\n    (0, $c5b9a1c6f844f372$export$ec068583843480e7)((0, $a781e7bcb429c993$export$4bf9923669ad6c63).inited, ()=>{\n        (0, $b5a61f6ff1db7acf$export$5153dfacc9e003db)((0, $234be5d0c6d8086c$export$5b2aa3892c7cd563)());\n        (0, $c151cb9ebf0d3253$export$a073caafba2bf897)((0, $300f44f1e0ff59c8$export$32d38b1480545060)());\n        (0, $44e8dcf7bc1235ff$export$2b2125c41df5d77)((0, $3a22c8333e3ffd71$export$7644b46c44c62576)());\n        (0, $44e8dcf7bc1235ff$export$9db81c2826f1f86f)((0, $3a22c8333e3ffd71$export$43f6d0e40c51b9cd)());\n        $f4155ce6e97e26c2$var$updateTagsHelper();\n    });\n    (0, $c5b9a1c6f844f372$export$ec068583843480e7)((0, $a781e7bcb429c993$export$4bf9923669ad6c63).addItem, (item)=>{\n        (0, $18fe714b7c5411fa$export$d9965447fadaae35)(item);\n        (0, $c151cb9ebf0d3253$export$c1a4300032ac0b7e)(item);\n        (0, $88ae43dff40ab9c2$export$2f62053d3c3a3e3e)();\n        $f4155ce6e97e26c2$var$updateTagsHelper();\n    });\n    (0, $c5b9a1c6f844f372$export$ec068583843480e7)((0, $a781e7bcb429c993$export$4bf9923669ad6c63).addTag, (tag)=>{\n        (0, $ab9cdb72c3c9787f$export$9136620570748e5)(tag);\n        (0, $b5a61f6ff1db7acf$export$5aae0045fcf71e3a)(tag);\n        (0, $84e1707131c903ad$export$6e142ec7d834c3f8)();\n        $f4155ce6e97e26c2$var$updateTagsHelper();\n    });\n    (0, $c5b9a1c6f844f372$export$ec068583843480e7)((0, $a781e7bcb429c993$export$4bf9923669ad6c63).addPeriod, (period)=>{\n        (0, $d427684b5f3168ee$export$e2a0d46e1b66d1c3)(period);\n        (0, $44e8dcf7bc1235ff$export$3852f45ed1ebb45d)(period);\n        (0, $39a9d2055ff57bb2$export$7c7da73463e50efc)(period);\n    });\n    (0, $c5b9a1c6f844f372$export$ec068583843480e7)((0, $a781e7bcb429c993$export$4bf9923669ad6c63).removeTag, (tag)=>{\n        (0, $ab9cdb72c3c9787f$export$db24519f95b43085)(tag);\n        removeTagFromList(tag.id);\n        $f4155ce6e97e26c2$var$updateTagsHelper();\n    });\n    (0, $c5b9a1c6f844f372$export$ec068583843480e7)((0, $a781e7bcb429c993$export$4bf9923669ad6c63).removeItem, (item)=>{\n        (0, $18fe714b7c5411fa$export$6d74f2e0bd134e69)(item);\n        (0, $c151cb9ebf0d3253$export$557da4bd554f1d64)(item.id);\n        $f4155ce6e97e26c2$var$updateTagsHelper();\n    });\n    (0, $c5b9a1c6f844f372$export$ec068583843480e7)((0, $a781e7bcb429c993$export$4bf9923669ad6c63).setActivePeriod, (activePeriod)=>{\n        (0, $c151cb9ebf0d3253$export$a073caafba2bf897)((0, $300f44f1e0ff59c8$export$32d38b1480545060)());\n        (0, $44e8dcf7bc1235ff$export$9db81c2826f1f86f)(activePeriod);\n    });\n}\n\n\n\n(0, $f4155ce6e97e26c2$export$718a88b4a3261429)();\n// Database\n(0, $5bf8e0affdca911c$export$28e7436902e0cf8b)().then(({ tags: tags, items: items, periods: periods })=>{\n    const periodsList = periods;\n    if (periods.length === 0) {\n        const basePeriod = {\n            id: 0,\n            createdAt: null\n        };\n        periodsList.push(basePeriod);\n        (0, $d427684b5f3168ee$export$e2a0d46e1b66d1c3)(basePeriod);\n    }\n    (0, $39a9d2055ff57bb2$export$41f27b3823a442c6)({\n        tags: tags,\n        items: items,\n        periods: periodsList\n    });\n});\n// Init\n(0, $88ae43dff40ab9c2$export$5aaae3b85e8f235d)({\n    onSubmit: (formData)=>{\n        const { text: text, price: price, tag: tag, subitems: subitems } = formData;\n        const createdAt = +new Date();\n        const newItem = {\n            id: (0, $22192c93a4d7ed30$export$bfc4ad7c1c5887fd)((0, $263aeadb784ad8cc$export$f55270c8f0a4bc82).items),\n            text: text,\n            price: price,\n            tag: tag,\n            createdAt: createdAt,\n            subitems: subitems.map((subitem)=>{\n                return {\n                    id: (0, $22192c93a4d7ed30$export$bfc4ad7c1c5887fd)((0, $263aeadb784ad8cc$export$f55270c8f0a4bc82).items),\n                    text: subitem.text,\n                    price: subitem.price,\n                    tag: subitem.tag,\n                    createdAt: createdAt\n                };\n            })\n        };\n        (0, $39a9d2055ff57bb2$export$fb9705de59d96855)(newItem);\n    }\n});\n(0, $84e1707131c903ad$export$5b882f86b632414c)({\n    onSubmit: (formData)=>{\n        const { name: name } = formData;\n        const newTag = {\n            id: (0, $22192c93a4d7ed30$export$bfc4ad7c1c5887fd)((0, $263aeadb784ad8cc$export$f55270c8f0a4bc82).tags),\n            name: name,\n            createdAt: +new Date()\n        };\n        (0, $39a9d2055ff57bb2$export$d220bf936897c3f)(newTag);\n    }\n});\n(0, $c151cb9ebf0d3253$export$ec6607eeb8c2a5d9)({\n    onRemove: (itemId)=>{\n        const item = (0, $300f44f1e0ff59c8$export$706e833710f71429)(itemId);\n        (0, $39a9d2055ff57bb2$export$fe2d9b4e03920b4c)(item);\n    }\n});\n(0, $b5a61f6ff1db7acf$export$68277c4d50aef9d4)({\n    onRemove: (tagId)=>{\n        const tag = (0, $234be5d0c6d8086c$export$187dba9db79742da)(tagId);\n        const tagItems = (0, $300f44f1e0ff59c8$export$6d93898069d99b40)(tagId);\n        if (tagItems.length) {\n            (0, $7cf706797b1cdf54$export$740944ffd2f8d33e)(\"Тег нельзя удалить\");\n            return;\n        }\n        (0, $39a9d2055ff57bb2$export$c21dc7c320b3abf4)(tag);\n    }\n});\n(0, $44e8dcf7bc1235ff$export$20db971c1716cf73)({\n    onStart: ()=>{\n        const newPeriod = {\n            id: (0, $22192c93a4d7ed30$export$bfc4ad7c1c5887fd)((0, $263aeadb784ad8cc$export$f55270c8f0a4bc82).periods),\n            createdAt: +new Date()\n        };\n        (0, $39a9d2055ff57bb2$export$960d87f3af6d13d2)(newPeriod);\n    },\n    onRemove: (periodId)=>{\n        const period = (0, $3a22c8333e3ffd71$export$d28142a7033885bd)(periodId);\n        (0, $39a9d2055ff57bb2$export$fa468d4bfa9d25b2)(period);\n    },\n    onSelect: (periodId)=>{\n        const period = (0, $3a22c8333e3ffd71$export$d28142a7033885bd)(periodId);\n        (0, $39a9d2055ff57bb2$export$7c7da73463e50efc)(period);\n    }\n});\n\n\n//# sourceMappingURL=index.5fb18a1b.js.map\n","import { addPeriodToDb, initDB } from \"./js/db\";\nimport {\n  addItem,\n  addPeriod,\n  addTag,\n  getNextId,\n  initStore,\n  removeItem,\n  removePeriod,\n  removeTag,\n  selectItemById,\n  selectItemsByTag,\n  selectPeriodById,\n  selectTagById,\n  setActivePeriod,\n  storeFields,\n} from \"./js/store\";\n\nimport {\n  initItemsList,\n  initNewItemForm,\n  initNewTagForm,\n  initPeriodsList,\n  initTagsList,\n} from \"./js/view\";\nimport { subscribeToStore } from \"./subscribe\";\nimport { notifyError } from \"./js/utils/notifier\";\n\nsubscribeToStore();\n\n// Database\ninitDB().then(({ tags, items, periods }) => {\n  const periodsList = periods;\n  if (periods.length === 0) {\n    const basePeriod = {\n      id: 0,\n      createdAt: null,\n    };\n    periodsList.push(basePeriod);\n    addPeriodToDb(basePeriod);\n  }\n\n  initStore({ tags, items, periods: periodsList });\n});\n\n// Init\ninitNewItemForm({\n  onSubmit: (formData) => {\n    const { text, price, tag, subitems } = formData;\n    const createdAt = +new Date();\n\n    const newItem = {\n      id: getNextId(storeFields.items),\n      text,\n      price,\n      tag,\n      createdAt,\n\n      subitems: subitems.map((subitem) => {\n        return {\n          id: getNextId(storeFields.items),\n          text: subitem.text,\n          price: subitem.price,\n          tag: subitem.tag,\n          createdAt,\n        };\n      }),\n    };\n\n    addItem(newItem);\n  },\n});\ninitNewTagForm({\n  onSubmit: (formData) => {\n    const { name } = formData;\n    const newTag = {\n      id: getNextId(storeFields.tags),\n      name,\n      createdAt: +new Date(),\n    };\n    addTag(newTag);\n  },\n});\ninitItemsList({\n  onRemove: (itemId) => {\n    const item = selectItemById(itemId);\n    removeItem(item);\n  },\n});\ninitTagsList({\n  onRemove: (tagId) => {\n    const tag = selectTagById(tagId);\n    const tagItems = selectItemsByTag(tagId);\n\n    if (tagItems.length) {\n      notifyError(\"Тег нельзя удалить\");\n      return;\n    }\n\n    removeTag(tag);\n  },\n});\ninitPeriodsList({\n  onStart: () => {\n    const newPeriod = {\n      id: getNextId(storeFields.periods),\n      createdAt: +new Date(),\n    };\n    addPeriod(newPeriod);\n  },\n  onRemove: (periodId) => {\n    const period = selectPeriodById(periodId);\n    removePeriod(period);\n  },\n  onSelect: (periodId) => {\n    const period = selectPeriodById(periodId);\n    setActivePeriod(period);\n  },\n});\n","export { initDB } from \"./init\";\nexport { addItemToDb, removeItemFromDb } from './items'\nexport { addTagToDb, removeTagFromDb } from './tags'\nexport { addPeriodToDb, removePeriodFromDb } from './periods'","import { notifyError } from \"../utils/notifier\";\nimport {\n  DB_NAME,\n  DB_VERSION,\n  ITEMS_STORE_NAME,\n  PERIODS_STORE_NAME,\n  TAGS_STORE_NAME,\n} from \"./constants\";\nimport { setDb } from \"./db\";\nimport { getStore } from \"./utils\";\n\nfunction getItems() {\n  return new Promise((resolve) => {\n    const items = getStore(ITEMS_STORE_NAME);\n    const request = items.getAll();\n    request.onsuccess = function () {\n      const result = request.result;\n      resolve(result);\n    };\n  });\n}\n\nasync function getTags() {\n  return new Promise((resolve) => {\n    const tags = getStore(TAGS_STORE_NAME);\n    const request = tags.getAll();\n    request.onsuccess = function () {\n      const result = request.result;\n      resolve(result);\n    };\n  });\n}\n\nasync function getPeriods() {\n  return new Promise((resolve) => {\n    const periods = getStore(PERIODS_STORE_NAME);\n    const request = periods.getAll();\n    request.onsuccess = function () {\n      const result = request.result;\n      resolve(result);\n    };\n  });\n}\n\nexport async function initDB() {\n  return new Promise((resolve) => {\n    const dbRequest = indexedDB.open(DB_NAME, DB_VERSION);\n    dbRequest.onupgradeneeded = function () {\n      let db = dbRequest.result;\n      if (!db.objectStoreNames.contains(ITEMS_STORE_NAME)) {\n        db.createObjectStore(ITEMS_STORE_NAME, { keyPath: \"id\" });\n      }\n      if (!db.objectStoreNames.contains(TAGS_STORE_NAME)) {\n        db.createObjectStore(TAGS_STORE_NAME, { keyPath: \"id\" });\n      }\n      if (!db.objectStoreNames.contains(PERIODS_STORE_NAME)) {\n        db.createObjectStore(PERIODS_STORE_NAME, { keyPath: \"id\" });\n      }\n    };\n    dbRequest.onerror = function () {\n      notifyError(\"DB ERROR\", dbRequest.error);\n    };\n    dbRequest.onsuccess = function () {\n      Promise.all([getTags(), getItems(), getPeriods()]).then(\n        ([tags, items, periods]) => {\n          resolve({ tags, items, periods });\n        }\n      );\n    };\n    setDb(dbRequest);\n  });\n}\n","export function notify(message, data) {\n  alert(message);\n  console.info(message, data);\n}\n\nexport function notifyError(message, data) {\n  alert(message);\n  console.error(message, data);\n}\n","export const DB_NAME = \"wallet\";\nexport const DB_VERSION = 4;\nexport const ITEMS_STORE_NAME = \"items\";\nexport const TAGS_STORE_NAME = \"tags\";\nexport const PERIODS_STORE_NAME = \"periods\"\n","let dbRequest;\n\nexport function setDb(db) {\n  dbRequest = db;\n}\n\nexport function getDb() {\n  return dbRequest.result;\n}\n","import { getDb } from \"./db\";\n\nexport function getStore(storeName, toWrite) {\n  let db = getDb();\n\n  let transaction = db.transaction(\n    storeName,\n    toWrite ? \"readwrite\" : \"readonly\"\n  );\n  let store = transaction.objectStore(storeName);\n  return store;\n}\n","import { getStore } from \"./utils\";\nimport { notify, notifyError } from \"../utils/notifier\";\nimport { ITEMS_STORE_NAME } from \"./constants\";\n\nexport function addItemToDb(item) {\n  const items = getStore(ITEMS_STORE_NAME, true);\n  let request = items.add(item);\n  request.onsuccess = function () {\n    notify(\"Запись успешно сохранена\");\n  };\n  request.onerror = function () {\n    notifyError(\"Не удалось сохранить запись\", request.error);\n  };\n}\n\nexport function removeItemFromDb(item) {\n  let items = getStore(ITEMS_STORE_NAME, true);\n  let request = items.delete(item.id);\n  request.onsuccess = function () {\n    notify(\"Запись успешно удалена\");\n  };\n  request.onerror = function () {\n    notifyError(\"Не удалось удалить запись\", request.error);\n  };\n}\n","import { notify, notifyError } from \"../utils/notifier\";\nimport { TAGS_STORE_NAME } from \"./constants\";\nimport { getStore } from \"./utils\";\n\nexport function addTagToDb(tag) {\n  let tags = getStore(TAGS_STORE_NAME, true);\n  let request = tags.add(tag);\n  request.onsuccess = function () {\n    notify(\"Запись успешно сохранена\");\n  };\n  request.onerror = function () {\n    notifyError(\"Не удалось сохранить запись\", request.error);\n  };\n}\n\nexport function removeTagFromDb(tag) {\n  let tags = getStore(TAGS_STORE_NAME, true);\n  let request = tags.delete(tag.id);\n  request.onsuccess = function () {\n    notify(\"Запись успешно удалена\");\n  };\n  request.onerror = function () {\n    notifyError(\"Не удалось удалить запись\", request.error);\n  };\n}\n","import { getStore } from \"./utils\";\nimport { notify, notifyError } from \"../utils/notifier\";\nimport { PERIODS_STORE_NAME } from \"./constants\";\n\nexport function addPeriodToDb(period) {\n  const periods = getStore(PERIODS_STORE_NAME, true);\n  let request = periods.add(period);\n  request.onsuccess = function () {\n    notify(\"Запись успешно сохранена\");\n  };\n  request.onerror = function () {\n    notifyError(\"Не удалось сохранить запись\", request.error);\n  };\n}\n\nexport function removePeriodFromDb(period) {\n  let periods = getStore(PERIODS_STORE_NAME, true);\n  let request = periods.delete(period.id);\n  request.onsuccess = function () {\n    notify(\"Запись успешно удалена\");\n  };\n  request.onerror = function () {\n    notifyError(\"Не удалось удалить запись\", request.error);\n  };\n}\n","export { subscribe } from \"./emitter\";\nexport { events } from \"./events\";\nexport { storeFields } from \"./constants\";\nexport { getNextId } from \"./ids\";\n\nexport { selectItems, selectItemById, selectFlatItems, selectItemsByTag, selectActiveItems } from \"./items\";\nexport { selectPeriods, selectPeriodById, selectActivePeriod } from \"./periods\";\nexport { selectTags, selectTagById, selectWeightedTags } from \"./tags\";\n\nexport {\n  initStore,\n  addItem,\n  addTag,\n  addPeriod,\n  removeItem,\n  removeTag,\n  removePeriod,\n  setActivePeriod,\n} from \"./state\";\n","const callbacks = {};\n\nexport function subscribe(eventName, eventCb) {\n  if (!(eventName in callbacks)) {\n    callbacks[eventName] = [];\n  }\n\n  callbacks[eventName].push(eventCb);\n}\n\nexport function emit(eventName, eventData) {\n  const eventCallbacks = callbacks[eventName];\n  if (!eventCallbacks) return;\n  eventCallbacks.forEach((cb) => cb(eventData));\n}\n","export const events = {\n  inited: \"store/inited\",\n\n  addItem: \"item/add\",\n  removeItem: \"item/remove\",\n\n  addTag: \"tag/add\",\n  removeTag: \"tag/remove\",\n\n  addPeriod: \"period/add\",\n  removePeriod: \"period/remove\",\n\n  setActivePeriod: \"activePeriod/set\",\n};\n","export const storeFields = {\n  items: \"items\",\n  periods: \"periods\",\n  tags: \"tags\",\n};\n","const ids = {};\n\nexport function getNextId(fieldName) {\n  if (!(fieldName in ids)) {\n    ids[fieldName] = 0;\n  }\n  return ++ids[fieldName];\n}\n\nexport function setLastId(fieldName, id) {\n  ids[fieldName] = id;\n}\n","import { getState } from \"./state\";\n\nexport function selectItems() {\n  return [...getState().items];\n}\n\nexport function selectItemById(itemId) {\n  const items = selectItems();\n  return items.find((i) => i.id === itemId);\n}\n\nexport function selectFlatItems() {\n  const items = [];\n  getState().items.forEach((item) => {\n    items.push(item);\n    items.push(...item.subitems);\n  });\n  return items;\n}\n\nexport function selectItemsByTag(tagId) {\n  const items = selectFlatItems();\n  return items.filter((i) => i.tag === tagId);\n}\n\nexport function selectActiveItems() {\n  const state = getState();\n\n  const period = state.activePeriod;\n\n  if (!period) {\n    return [...state.items];\n  }\n\n  const periodIndex = state.periods.findIndex((p) => p.id === period.id);\n  const nextPeriod = state.periods[periodIndex + 1];\n\n  return state.items.filter((item) => {\n    if (period.createdAt && item.createdAt < period.createdAt) return false;\n    if (nextPeriod && item.createdAt >= nextPeriod.createdAt) return false;\n    return true;\n  });\n}\n","import { storeFields } from \"./constants\";\nimport { emit } from \"./emitter\";\nimport { events } from \"./events\";\nimport { setLastId } from \"./ids\";\n\nconst state = {\n  items: [],\n  tags: [],\n  periods: [],\n  activePeriod: null,\n};\n\nexport function getState() {\n  return { ...state };\n}\n\nexport function initStore({\n  tags: tagsList,\n  items: itemsList,\n  periods: periodsList,\n}) {\n  if (tagsList.length > 0) {\n    setLastId(storeFields.tags, tagsList[tagsList.length - 1].id);\n    state.tags = tagsList;\n  }\n\n  if (itemsList.length > 0) {\n    setLastId(storeFields.items, itemsList[itemsList.length - 1].id);\n    state.items = itemsList;\n  }\n\n  if (periodsList.length > 0) {\n    const lastPeriod = periodsList[periodsList.length - 1];\n    setLastId(storeFields.periods, lastPeriod.id);\n    state.periods = periodsList;\n    state.activePeriod = lastPeriod;\n  }\n\n  emit(events.inited, state);\n}\n\nexport function addItem(item) {\n  state.items.push(item);\n  emit(events.addItem, item);\n}\n\nexport function addTag(tag) {\n  state.tags.push(tag);\n  emit(events.addTag, tag);\n}\n\nexport function addPeriod(period) {\n  state.periods.push(period);\n  emit(events.addPeriod, period);\n}\n\nexport function removeItem(item) {\n  state.items = state.items.filter((i) => i.id !== item.id);\n  emit(events.removeItem, item);\n}\n\nexport function removeTag(tag) {\n  state.tags = state.tags.filter((t) => t.id !== tag.id);\n  emit(events.removeTag, tag);\n}\n\nexport function removePeriod(period) {\n  state.periods = state.items.filter((p) => p.id !== period.id);\n  emit(events.removePeriod, period);\n}\n\nexport function setActivePeriod(period) {\n  state.activePeriod = period;\n  emit(events.setActivePeriod, period);\n}\n","import { getState } from \"./state\";\n\nexport function selectPeriods() {\n  return getState().periods;\n}\n\nexport function selectPeriodById(periodId) {\n  const periods = selectPeriods();\n  return periods.find((p) => p.id === periodId);\n}\n\nexport function selectActivePeriod() {\n  return getState().activePeriod;\n}\n","import { selectFlatItems } from \"./items\";\nimport { getState } from \"./state\";\n\nexport function selectTags() {\n  return [...getState().tags];\n}\n\nexport function selectTagById(tagId) {\n  const tags = selectTags();\n  return tags.find((t) => t.id === tagId);\n}\n\nfunction selectTagsWeight() {\n  const state = getState();\n\n  const items = selectFlatItems();\n  const weight = {};\n  state.tags.forEach((tag) => {\n    weight[tag.id] = 0;\n  });\n  items.forEach((item) => {\n    weight[item.tag] += 1;\n  });\n  return weight;\n}\n\nexport function selectWeightedTags() {\n  const tags = selectTags();\n  const weight = selectTagsWeight();\n\n  tags.sort((a, b) => weight[b.id] - weight[a.id]);\n\n  return tags;\n}\n","export {\n  updateTagsSelect,\n  closeNewItemForm,\n  initNewItemForm,\n} from \"./itemForm\";\n\nexport { closeNewTagForm, initNewTagForm } from \"./tagForm\";\n\nexport {\n  renderItemsList,\n  addItemToList,\n  removeItemFromList,\n  initItemsList,\n} from \"./items\";\n\nexport {\n  renderTagsList,\n  addTagToList,\n  removeTagFromList,\n  initTagsList,\n} from \"./tags\";\n\nexport {\n  renderPeriodsList,\n  addPeriodToList,\n  removePeriodFromList,\n  initPeriodsList,\n  highlightActivePeriod\n} from \"./periods\";\n","import { selectWeightedTags } from \"../store\";\nimport { IDS, getElement, getTemplate } from \"./elements\";\n\nconst selectors = {\n  subitem: \".subitem-form\",\n};\n\nfunction renderSubitemForm() {\n  const $clone = getTemplate(IDS.itemForm.subitemTemplate);\n\n  const $subitem = $clone.querySelector(selectors.subitem);\n  const $subitemSelect = $subitem.querySelector(\"select\");\n\n  const tags = selectWeightedTags()\n\n  tags.forEach((tag) => {\n    const $tag = renderTagOption(tag);\n    $subitemSelect.appendChild($tag);\n  });\n\n  return $subitem;\n}\n\nfunction renderTagOption(tag) {\n  const $option = document.createElement(\"option\");\n  $option.textContent = tag.name;\n  $option.value = tag.id;\n  return $option;\n}\n\nexport function updateTagsSelect(tags) {\n  const $tagsSelect = getElement(IDS.itemForm.tagsSelect);\n  $tagsSelect.innerHTML = \"\";\n  tags.forEach((tag) => {\n    const $option = renderTagOption(tag);\n    $tagsSelect.appendChild($option);\n  });\n}\n\nfunction resetNewItemForm() {\n  const $newItemForm = getElement(IDS.itemForm.form);\n  const $newItemFormSubitemsList = getElement(IDS.itemForm.subitemsList);\n\n  $newItemForm.reset();\n  $newItemFormSubitemsList.innerHTML = \"\";\n}\n\nfunction openNewItemForm() {\n  const $newItemDialog = getElement(IDS.itemForm.dialog);\n  $newItemDialog.showModal();\n}\n\nexport function closeNewItemForm() {\n  const $newItemDialog = getElement(IDS.itemForm.dialog);\n  $newItemDialog.close();\n  resetNewItemForm();\n}\n\nfunction getNewItemFormData() {\n  const $newItemForm = getElement(IDS.itemForm.form);\n\n  const fd = new FormData($newItemForm);\n\n  const subitemTexts = fd.getAll(\"subitems[text][]\");\n  const subitemPrices = fd.getAll(\"subitems[price][]\");\n  const subitemTags = fd.getAll(\"subitems[tag][]\");\n\n  return {\n    text: fd.get(\"text\"),\n    price: fd.get(\"price\"),\n    tag: Number(fd.get(\"tag\")),\n\n    subitems: subitemTexts.map((text, i) => {\n      return {\n        text,\n        price: subitemPrices[i],\n        tag: Number(subitemTags[i]),\n      };\n    }),\n  };\n}\n\nexport function initNewItemForm(config) {\n  const { onSubmit } = config;\n\n  const $newItemForm = getElement(IDS.itemForm.form);\n  const $addItemButton = getElement(IDS.itemForm.addButton);\n  const $closeDialogButton = getElement(IDS.itemForm.closeButton);\n  const $addSubitemButton = getElement(IDS.itemForm.addSubitemBtn);\n  const $subitemsList = getElement(IDS.itemForm.subitemsList);\n\n  $newItemForm.addEventListener(\"submit\", (e) => {\n    e.preventDefault();\n\n    onSubmit(getNewItemFormData());\n  });\n\n  $addItemButton.addEventListener(\"click\", () => {\n    openNewItemForm();\n  });\n\n  $closeDialogButton.addEventListener(\"click\", () => {\n    closeNewItemForm();\n  });\n\n  $addSubitemButton.addEventListener(\"click\", () => {\n    const $subitemForm = renderSubitemForm();\n    $subitemsList.appendChild($subitemForm);\n  });\n}\n","export const IDS = {\n  items: {\n    list: \"items\",\n    template: \"item-tmpl\",\n    subitemTemplate: \"subitem-tmpl\",\n  },\n\n  itemForm: {\n    dialog: \"new-item-dialog\",\n    form: \"new-item-form\",\n    addButton: \"add-item\",\n    closeButton: \"close-new-item-dialog\",\n    subitemsList: \"new-item-form-subitems\",\n    tagsSelect: \"tags-select\",\n    addSubitemBtn: \"new-item-add-subitem\",\n    subitemTemplate: \"subitem-form-tmpl\",\n  },\n\n  tags: {\n    list: \"tags\",\n    template: \"tag-tmpl\",\n    aside: \"tags-sidebar\",\n    toggleListBtn: \"tags-toggle\",\n  },\n\n  tagForm: {\n    dialog: \"new-tag-dialog\",\n    form: \"new-tag-form\",\n    addButton: \"add-tag\",\n    closeButton: \"close-new-tag-dialog\",\n  },\n\n  periods: {\n    toggleButton: 'periods-toggle',\n    startButton: 'start-period',\n    aside: 'periods-sidebar',\n    list: 'periods-list',\n    periodTemplate: 'period-tmpl'\n  }\n};\n\nconst cache = {};\n\nexport function getElement(id) {\n  if (cache[id]) return cache[id];\n\n  const element = document.getElementById(id);\n  cache[id] = element;\n  return element;\n}\n\nexport function getTemplate(id) {\n  const template = getElement(id);\n  const $clone = template.content.cloneNode(true);\n  return $clone;\n}\n","import { selectTags } from \"../store\";\nimport { notifyError } from \"../utils/notifier\";\nimport { IDS, getElement } from \"./elements\";\n\nfunction resetNewTagForm() {\n  const $newTagForm = getElement(IDS.tagForm.form);\n  $newTagForm.reset();\n}\n\nfunction openNewTagForm() {\n  const $newTagDialog = getElement(IDS.tagForm.dialog);\n  $newTagDialog.showModal();\n}\n\nexport function closeNewTagForm() {\n  const $newTagDialog = getElement(IDS.tagForm.dialog);\n  $newTagDialog.close();\n  resetNewTagForm();\n}\n\nfunction getNewTagFormData() {\n  const $newTagForm = getElement(IDS.tagForm.form);\n  return {\n    name: $newTagForm.elements.name.value,\n  };\n}\n\nexport function initNewTagForm(config) {\n  const { onSubmit } = config;\n\n  const $newTagForm = getElement(IDS.tagForm.form);\n  const $addTagButton = getElement(IDS.tagForm.addButton);\n  const $closeDialogButton = getElement(IDS.tagForm.closeButton);\n\n  $newTagForm.addEventListener(\"submit\", (e) => {\n    e.preventDefault();\n\n    const formData = getNewTagFormData();\n    if (!formData.name) {\n      notifyError(\"Не заполнено поле name\", { formData });\n      return;\n    }\n\n    const tags = selectTags();\n    const isDouble = tags.some((t) => t.name === formData.name);\n    if (isDouble) {\n      notifyError(`Тег с именем ${formData.name} уже добавлен`, { formData });\n      return;\n    }\n\n    onSubmit(formData);\n  });\n\n  $addTagButton.addEventListener(\"click\", () => {\n    openNewTagForm();\n  });\n\n  $closeDialogButton.addEventListener(\"click\", () => {\n    closeNewTagForm();\n  });\n}\n","import { selectTagById } from \"../store\";\nimport { IDS, getElement, getTemplate } from \"./elements\";\n\nconst selectors = {\n  item: \".item\",\n  itemText: \".item-text\",\n  itemPrice: \".item-price\",\n  itemTag: \".item-tag\",\n  itemRemove: \".item-remove\",\n\n  subitems: \".item-subitems\",\n\n  subitem: \".subitem\",\n  subitemText: \".subitem-text\",\n  subitemPrice: \".subitem-price\",\n  subitemTag: \".subitem-tag\",\n};\n\nfunction renderSubitem(subitem) {\n  const $clone = getTemplate(IDS.items.subitemTemplate);\n\n  const $subitem = $clone.querySelector(selectors.subitem);\n  $subitem.querySelector(selectors.subitemText).textContent = subitem.text;\n  $subitem.querySelector(selectors.subitemPrice).textContent = subitem.price;\n\n  const subitemTag = selectTagById(subitem.tag)\n  $subitem.querySelector(selectors.subitemTag).textContent =\n    subitemTag?.name || \"\";\n\n  return $subitem;\n}\n\nfunction renderItem(item) {\n  const $clone = getTemplate(IDS.items.template);\n\n  const $item = $clone.querySelector(selectors.item);\n  $item.dataset.itemId = item.id;\n  $item.querySelector(selectors.itemText).textContent = item.text;\n  $item.querySelector(selectors.itemPrice).textContent = item.price;\n\n  const itemTag = selectTagById(item.tag);\n  $item.querySelector(selectors.itemTag).textContent = itemTag?.name || \"\";\n\n  if (item.subitems?.length > 0) {\n    const $subitemsList = $item.querySelector(selectors.subitems);\n    item.subitems.forEach((subitem) => {\n      const $subitem = renderSubitem(subitem);\n      $subitemsList.appendChild($subitem);\n    });\n  }\n\n  return $item;\n}\n\nexport function renderItemsList(items) {\n  const $itemsList = getElement(IDS.items.list);\n  $itemsList.innerHTML = \"\";\n\n  items.forEach((item) => {\n    const $item = renderItem(item);\n    $itemsList.appendChild($item);\n  });\n}\n\nexport function addItemToList(item) {\n  const $item = renderItem(item);\n\n  const $itemsList = getElement(IDS.items.list);\n  $itemsList.appendChild($item);\n}\n\nexport function removeItemFromList(itemId) {\n  const $element = document.querySelector(`[data-item-id=\"${itemId}\"]`);\n  $element.remove();\n}\n\nexport function initItemsList(config) {\n  const { onRemove } = config;\n\n  const $itemsList = getElement(IDS.items.list);\n  $itemsList.addEventListener(\"click\", (e) => {\n    const $removeButton = e.target.closest(selectors.itemRemove);\n    if ($removeButton) {\n      const $tag = e.target.closest(selectors.item);\n      onRemove(Number($tag.dataset.itemId));\n    }\n  });\n}\n","import { IDS, getElement, getTemplate } from \"./elements\";\n\nconst selectors = {\n  tag: \".tag\",\n  tagName: \".tag-name\",\n  tagRemove: \".tag-remove\",\n};\n\nfunction renderTag(tag) {\n  const $clone = getTemplate(IDS.tags.template);\n\n  const $tag = $clone.querySelector(selectors.tag);\n  $tag.dataset.tagId = tag.id;\n  $tag.querySelector(selectors.tagName).textContent = tag.name;\n  return $tag;\n}\n\nexport function renderTagsList(tags) {\n  const $tagsList = getElement(IDS.tags.list);\n  $tagsList.innerHTML = \"\";\n\n  tags.forEach((tag) => {\n    const $tag = renderTag(tag);\n    $tagsList.appendChild($tag);\n  });\n}\n\nexport function addTagToList(tag) {\n  const $tagsList = getElement(IDS.tags.list);\n\n  const $tag = renderTag(tag);\n  $tagsList.appendChild($tag);\n}\n\nexport function removeTagFromList(tagId) {\n  const $element = document.querySelector(`[data-tag-id=\"${tagId}\"]`);\n  $element.remove();\n}\n\nexport function initTagsList(config) {\n  const { onRemove } = config;\n\n  const $tagsList = getElement(IDS.tags.list);\n  $tagsList.addEventListener(\"click\", (e) => {\n    const $removeButton = e.target.closest(selectors.tagRemove);\n    if ($removeButton) {\n      const $tag = e.target.closest(selectors.tag);\n      onRemove(Number($tag.dataset.tagId));\n    }\n  });\n\n  const $tagsToggleButton = getElement(IDS.tags.toggleListBtn);\n  const $tagsSidebar = getElement(IDS.tags.aside);\n\n  $tagsToggleButton.addEventListener(\"click\", () => {\n    if ($tagsSidebar.hasAttribute(\"data-open\")) {\n      $tagsSidebar.removeAttribute(\"data-open\");\n    } else {\n      $tagsSidebar.setAttribute(\"data-open\", \"true\");\n    }\n  });\n}\n","import { formatDate } from \"../utils/date\";\nimport { IDS, getElement, getTemplate } from \"./elements\";\n\nconst selectors = {\n  period: \".period\",\n  periodStart: \".period-start\",\n  periodEnd: \".period-end\",\n  periodRemove: \".period-remove\",\n};\n\nfunction renderPeriod(period, nextPeriod) {\n  const $clone = getTemplate(IDS.periods.periodTemplate);\n\n  const $period = $clone.querySelector(selectors.period);\n  $period.dataset.periodId = period.id;\n\n  const start = new Date(period.createdAt);\n  const end = nextPeriod ? new Date(nextPeriod.createdAt) : null;\n\n  $period.querySelector(selectors.periodStart).textContent = `с ${formatDate(\n    start\n  )}`;\n  $period.querySelector(selectors.periodEnd).textContent = end\n    ? `по ${formatDate(end)}`\n    : `...`;\n\n  return $period;\n}\n\nexport function renderPeriodsList(periods) {\n  const $periodsList = getElement(IDS.periods.list);\n  $periodsList.innerHTML = \"\";\n\n  periods.forEach((period, i) => {\n    const $period = renderPeriod(period, periods[i + 1]);\n    $periodsList.appendChild($period);\n  });\n}\n\nexport function addPeriodToList(period) {\n  const $periodsList = getElement(IDS.periods.list);\n  const $period = renderPeriod(period);\n  $periodsList.appendChild($period);\n}\n\nexport function removePeriodFromList(periodId) {\n  const $element = document.querySelector(`[data-period-id=\"${periodId}\"]`);\n  $element.remove();\n}\n\nexport function initPeriodsList(config) {\n  const { onStart, onRemove, onSelect } = config;\n\n  const $toggleButton = getElement(IDS.periods.toggleButton);\n  const $periodsSidebar = getElement(IDS.periods.aside);\n  const $periodsList = getElement(IDS.periods.list);\n  const $startButton = getElement(IDS.periods.startButton);\n\n  $toggleButton.addEventListener(\"click\", () => {\n    if ($periodsSidebar.hasAttribute(\"data-open\")) {\n      $periodsSidebar.removeAttribute(\"data-open\");\n    } else {\n      $periodsSidebar.setAttribute(\"data-open\", \"true\");\n    }\n  });\n\n  $periodsList.addEventListener(\"click\", (e) => {\n    const $removeButton = e.target.closest(selectors.periodRemove);\n    if ($removeButton) {\n      const $period = e.target.closest(selectors.period);\n      onRemove(Number($period.dataset.periodId));\n      return;\n    }\n\n    const $period = e.target.closest(selectors.period);\n    if ($period) {\n      onSelect(Number($period.dataset.periodId));\n    }\n  });\n\n  $startButton.addEventListener(\"click\", onStart);\n}\n\nexport function highlightActivePeriod(period) {\n\n}","export function formatDate(date) {\n  return `${date.getDate()}.${date.getMonth() + 1}.${date.getFullYear()}`;\n}\n","import { addItemToDb, addPeriodToDb, addTagToDb, removeItemFromDb, removeTagFromDb } from \"./js/db\";\nimport {\n  events,\n  selectActiveItems,\n  selectActivePeriod,\n  selectPeriods,\n  selectTags,\n  selectWeightedTags,\n  setActivePeriod,\n  subscribe,\n} from \"./js/store\";\nimport { addItemToList, addPeriodToList, addTagToList, closeNewItemForm, closeNewTagForm, highlightActivePeriod, removeItemFromList, renderItemsList, renderPeriodsList, renderTagsList, updateTagsSelect } from \"./js/view\";\n\nfunction updateTagsHelper() {\n  updateTagsSelect(selectWeightedTags());\n}\n\nexport function subscribeToStore() {\n  subscribe(events.inited, () => {\n    renderTagsList(selectTags());\n    renderItemsList(selectActiveItems());\n    renderPeriodsList(selectPeriods());\n    highlightActivePeriod(selectActivePeriod());\n    updateTagsHelper();\n  });\n\n  subscribe(events.addItem, (item) => {\n    addItemToDb(item);\n    addItemToList(item);\n    closeNewItemForm();\n    updateTagsHelper();\n  });\n\n  subscribe(events.addTag, (tag) => {\n    addTagToDb(tag);\n    addTagToList(tag);\n    closeNewTagForm();\n    updateTagsHelper();\n  });\n\n  subscribe(events.addPeriod, (period) => {\n    addPeriodToDb(period);\n    addPeriodToList(period);\n    setActivePeriod(period);\n  });\n\n  subscribe(events.removeTag, (tag) => {\n    removeTagFromDb(tag);\n    removeTagFromList(tag.id);\n    updateTagsHelper();\n  });\n\n  subscribe(events.removeItem, (item) => {\n    removeItemFromDb(item);\n    removeItemFromList(item.id);\n    updateTagsHelper();\n  });\n\n  subscribe(events.setActivePeriod, (activePeriod) => {\n    renderItemsList(selectActiveItems());\n    highlightActivePeriod(activePeriod);\n  });\n}\n"],"names":["$10b482129a116bb0$var$dbRequest","$7cf706797b1cdf54$export$5e14cdade93d6f7b","message","data","alert","console","info","$7cf706797b1cdf54$export$740944ffd2f8d33e","error","$cb5f343bb15c779a$export$ecb8b5d0fe61b71e","$cb5f343bb15c779a$export$1ccac7a1df77a4d0","$cb5f343bb15c779a$export$a0ecdc0caa7bc41f","$f0e3980f5caecdc4$export$6fec604aa7293d0c","storeName","toWrite","transaction","db","result","objectStore","$5bf8e0affdca911c$var$getTags","Promise","resolve","tags","request","getAll","onsuccess","$5bf8e0affdca911c$var$getPeriods","periods","$5bf8e0affdca911c$export$28e7436902e0cf8b","dbRequest","indexedDB","open","onupgradeneeded","objectStoreNames","contains","createObjectStore","keyPath","onerror","all","items","then","$d427684b5f3168ee$export$e2a0d46e1b66d1c3","period","add","$c5b9a1c6f844f372$var$callbacks","$c5b9a1c6f844f372$export$ec068583843480e7","eventName","eventCb","push","$c5b9a1c6f844f372$export$8f35fbd5db0f3634","eventData","eventCallbacks","forEach","cb","$a781e7bcb429c993$export$4bf9923669ad6c63","inited","addItem","removeItem","addTag","removeTag","addPeriod","removePeriod","setActivePeriod","$263aeadb784ad8cc$export$f55270c8f0a4bc82","$22192c93a4d7ed30$var$ids","$22192c93a4d7ed30$export$bfc4ad7c1c5887fd","fieldName","$39a9d2055ff57bb2$var$state","activePeriod","$39a9d2055ff57bb2$export$50fdfeece43146fd","$39a9d2055ff57bb2$export$7c7da73463e50efc","$300f44f1e0ff59c8$export$a59067c931da7aa8","item","subitems","$300f44f1e0ff59c8$export$32d38b1480545060","state","periodIndex","findIndex","p","id","nextPeriod","filter","createdAt","$3a22c8333e3ffd71$export$7644b46c44c62576","$3a22c8333e3ffd71$export$d28142a7033885bd","periodId","find","$234be5d0c6d8086c$export$5b2aa3892c7cd563","$234be5d0c6d8086c$export$187dba9db79742da","tagId","t","$234be5d0c6d8086c$export$7683f595ce888d9d","weight","$234be5d0c6d8086c$var$selectTagsWeight","tag","sort","a","b","$562b1b97bd523649$export$82babaa65029102d","list","template","subitemTemplate","itemForm","dialog","form","addButton","closeButton","subitemsList","tagsSelect","addSubitemBtn","aside","toggleListBtn","tagForm","toggleButton","startButton","periodTemplate","$562b1b97bd523649$var$cache","$562b1b97bd523649$export$d16800b7e59a8051","element","document","getElementById","$562b1b97bd523649$export$9b1a70d8e05b0fa6","$clone","content","cloneNode","$88ae43dff40ab9c2$var$renderTagOption","$option","createElement","textContent","name","value","$88ae43dff40ab9c2$export$2f62053d3c3a3e3e","$newItemDialog","close","$88ae43dff40ab9c2$var$resetNewItemForm","$newItemForm","$newItemFormSubitemsList","reset","innerHTML","$84e1707131c903ad$export$6e142ec7d834c3f8","$newTagDialog","$84e1707131c903ad$var$resetNewTagForm","$newTagForm","$c151cb9ebf0d3253$var$selectors","itemText","itemPrice","itemTag","itemRemove","subitem","subitemText","subitemPrice","subitemTag","$c151cb9ebf0d3253$var$renderItem","$item","querySelector","dataset","itemId","text","price","length","$subitemsList","$subitem","$c151cb9ebf0d3253$var$renderSubitem","appendChild","$c151cb9ebf0d3253$export$a073caafba2bf897","$itemsList","$b5a61f6ff1db7acf$var$selectors","tagName","tagRemove","$b5a61f6ff1db7acf$var$renderTag","$tag","$133b04bf6dc64688$export$3ae94a2503e890a1","date","getDate","getMonth","getFullYear","$44e8dcf7bc1235ff$var$selectors","periodStart","periodEnd","periodRemove","$44e8dcf7bc1235ff$var$renderPeriod","$period","start","Date","end","$f4155ce6e97e26c2$var$updateTagsHelper","$tagsSelect","$tagsList","$periodsList","i","delete","removeTagFromList","$element","remove","basePeriod","periodsList","tagsList","itemsList","lastPeriod","config","onSubmit","$addItemButton","$closeDialogButton","$addSubitemButton","addEventListener","e","preventDefault","$88ae43dff40ab9c2$var$getNewItemFormData","fd","FormData","subitemTexts","subitemPrices","subitemTags","get","Number","map","$88ae43dff40ab9c2$var$openNewItemForm","showModal","$subitemForm","$88ae43dff40ab9c2$var$renderSubitemForm","$subitemSelect","formData","newItem","$addTagButton","$84e1707131c903ad$var$getNewTagFormData","elements","isDouble","some","$84e1707131c903ad$var$openNewTagForm","newTag","onRemove","$removeButton","target","closest","$tagsToggleButton","$tagsSidebar","hasAttribute","removeAttribute","setAttribute","tagItems","onStart","onSelect","$toggleButton","$periodsSidebar","$startButton","newPeriod"],"version":3,"file":"index.5fb18a1b.js.map"}